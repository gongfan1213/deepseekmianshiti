> ğŸ’­ ä»Šå¤©åœ¨å­¦ä¹ Node.jsçš„æ—¶å€™ï¼Œé‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå…³äºå•çº¿ç¨‹æ¨¡å‹å¦‚ä½•å¤„ç†é«˜å¹¶å‘ä»¥åŠå¤šè¿›ç¨‹çš„æ¶æ„å¦‚ä½•å®ç°ã€‚ä¸€å¼€å§‹ï¼Œæˆ‘å¯¹è¿™ä¸¤ä¸ªæ¦‚å¿µæœ‰ç‚¹æ··æ·†ï¼Œç‰¹åˆ«æ˜¯å•çº¿ç¨‹æ€ä¹ˆèƒ½å¤ŸåŒæ—¶å¤„ç†é‚£ä¹ˆå¤šè¯·æ±‚ï¼Œè§‰å¾—æœ‰ç‚¹åç›´è§‰ã€‚äºæ˜¯å†³å®šæ·±å…¥ç†è§£ä¸€ä¸‹ã€‚
>
> é¦–å…ˆï¼Œæˆ‘å¾—å›å¿†ä¸€ä¸‹è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ã€‚è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿåˆ†é…èµ„æºçš„åŸºæœ¬å•ä½ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œè€Œçº¿ç¨‹æ˜¯è¿›ç¨‹å†…çš„æ‰§è¡Œå•å…ƒï¼Œå…±äº«åŒä¸€è¿›ç¨‹çš„èµ„æºã€‚å¯æ˜¯Node.jsæ˜¯å•çº¿ç¨‹çš„ï¼Œé‚£ä¸ºä»€ä¹ˆèƒ½å¤„ç†é«˜å¹¶å‘å‘¢ï¼Ÿå¯èƒ½å’Œå¼‚æ­¥éé˜»å¡I/Oæœ‰å…³å§ï¼Ÿæ¯”å¦‚ï¼Œå½“å‘èµ·ä¸€ä¸ªç½‘ç»œè¯·æ±‚æ—¶ï¼ŒNode.jsä¸ä¼šç­‰å¾…å“åº”ï¼Œè€Œæ˜¯ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œç­‰I/Oå®Œæˆåå†é€šè¿‡å›è°ƒå¤„ç†ç»“æœã€‚ä½†è¿™æ ·çš„è§£é‡Šæ˜¯å¦å®Œå…¨æ­£ç¡®å‘¢ï¼Ÿ
>
> æ¥ä¸‹æ¥æƒ³åˆ°çš„æ˜¯äº‹ä»¶å¾ªç¯æœºåˆ¶ã€‚Node.jsçš„äº‹ä»¶å¾ªç¯å…è®¸å®ƒåœ¨å•ä¸ªçº¿ç¨‹ä¸­å¤„ç†å¤šä¸ªæ“ä½œï¼Œé€šè¿‡å°†å¼‚æ­¥ä»»åŠ¡äº¤ç»™ç³»ç»Ÿå†…æ ¸æ‰§è¡Œï¼Œè€Œä¸»çº¿ç¨‹ç»§ç»­å¤„ç†å…¶ä»–ä»»åŠ¡ã€‚è¿™æ ·ï¼Œè™½ç„¶JavaScriptä»£ç æ˜¯å•çº¿ç¨‹è¿è¡Œçš„ï¼Œä½†èƒŒåçš„I/Oæ“ä½œæ˜¯å¤šçº¿ç¨‹çš„ï¼ˆæ¯”å¦‚é€šè¿‡libuvåº“ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé«˜å¹¶å‘çš„å¤„ç†èƒ½åŠ›ä¸»è¦ä¾èµ–äºå¼‚æ­¥I/Oå’Œäº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œè€Œä¸æ˜¯å¤šçº¿ç¨‹çš„å¹¶è¡Œæ‰§è¡Œã€‚å½“ç„¶ï¼Œè¿™åªæ˜¯æˆ‘çš„åˆæ­¥ç†è§£ï¼Œéœ€è¦éªŒè¯æ˜¯å¦æ­£ç¡®ã€‚
>
> å…³äºå¤šè¿›ç¨‹æ¶æ„çš„å®ç°ï¼Œæ¯”å¦‚Node.jsä¸­çš„clusteræ¨¡å—ï¼Œå¦‚ä½•åˆ©ç”¨å¤šæ ¸CPUï¼Ÿä¸»è¿›ç¨‹å’Œå­è¿›ç¨‹ä¹‹é—´æ˜¯å¦‚ä½•åˆ†å·¥çš„ï¼Ÿæ¯ä¸ªå­è¿›ç¨‹éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å®ä¾‹ï¼Œæ‹¥æœ‰è‡ªå·±çš„äº‹ä»¶å¾ªç¯å—ï¼Ÿå¦‚ä½•é¿å…ç«¯å£å†²çªï¼Ÿåº”è¯¥æœ‰ä¸»è¿›ç¨‹ç›‘å¬ç«¯å£ï¼Œç„¶åå°†è¯·æ±‚åˆ†å‘ç»™å­è¿›ç¨‹å¤„ç†ã€‚æ¯”å¦‚ä½¿ç”¨round-robinç®—æ³•åˆ†é…è¯·æ±‚ã€‚è¿™æ ·çš„æ¶æ„èƒ½å¤Ÿå……åˆ†åˆ©ç”¨å¤šæ ¸CPUï¼Œæé«˜åº”ç”¨çš„ååé‡å’Œç¨³å®šæ€§ã€‚
>
> ç„¶åè”æƒ³åˆ°PM2è¿™æ ·çš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œåº”è¯¥ä¹Ÿæ˜¯åŸºäºç±»ä¼¼çš„åŸç†ï¼Œç®¡ç†å¤šä¸ªNode.jså®ä¾‹ï¼Œå¹¶åœ¨å®ƒä»¬ä¹‹é—´åšè´Ÿè½½å‡è¡¡ã€‚é‚£PM2å’Œclusteræ¨¡å—çš„å…³ç³»åˆæ˜¯æ€æ ·çš„å‘¢ï¼Ÿå¯èƒ½åœ¨clusterçš„åŸºç¡€ä¸Šåšäº†æ›´å¤šçš„å°è£…å’ŒåŠŸèƒ½å¢å¼ºï¼Œæ¯”å¦‚è‡ªåŠ¨é‡å¯ã€æ—¥å¿—ç®¡ç†ç­‰ã€‚
>
> ä¸è¿‡è¿˜å­˜åœ¨ç–‘é—®ï¼Œæ¯”å¦‚å•çº¿ç¨‹åœ¨CPUå¯†é›†å‹ä»»åŠ¡ä¸­çš„è¡¨ç°å¦‚ä½•ï¼Ÿç”±äºæ˜¯å•çº¿ç¨‹ï¼Œé•¿æ—¶é—´è¿è¡Œçš„åŒæ­¥ä»»åŠ¡ä¼šé˜»å¡äº‹ä»¶å¾ªç¯ï¼Œå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚è¿™æ—¶å€™ï¼Œä½¿ç”¨å¤šè¿›ç¨‹æˆ–è€…å°†ä»»åŠ¡æ‹†åˆ†åˆ°å·¥ä½œçº¿ç¨‹ï¼ˆworker_threadsï¼‰å¯èƒ½æ›´æœ‰æ•ˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºI/Oå¯†é›†å‹åº”ç”¨ï¼ŒNode.jsçš„å•çº¿ç¨‹æ¨¡å‹é«˜æ•ˆï¼›å¯¹äºCPUå¯†é›†å‹ä»»åŠ¡ï¼Œéœ€è¦é‡‡ç”¨å¤šè¿›ç¨‹æˆ–å¤šçº¿ç¨‹æ¥æé«˜æ€§èƒ½ã€‚
>
> å¦å¤–ï¼Œè¿›ç¨‹é—´é€šä¿¡æ˜¯å¦‚ä½•è¿›è¡Œçš„ï¼Ÿåœ¨clusteræ¨¡å—ä¸­ï¼Œä¸»è¿›ç¨‹å’Œå­è¿›ç¨‹ä¹‹é—´å¯ä»¥é€šè¿‡IPCï¼ˆInter-Process Communicationï¼‰ä¼ é€’æ¶ˆæ¯ï¼Œè¿™ç§é€šä¿¡æ–¹å¼ä¸çº¿ç¨‹é—´çš„å…±äº«å†…å­˜æœ‰ä»€ä¹ˆä¸åŒï¼ŸIPCå¯èƒ½æ›´ä¸ºé‡é‡çº§ï¼Œè€Œçº¿ç¨‹é—´å…±äº«å†…å­˜å’Œèµ„æºæ›´é«˜æ•ˆï¼Œä½†ä¹Ÿæ›´å¤æ‚ã€‚ä¸è¿‡Node.jsä¸­é€šå¸¸å»ºè®®ä½¿ç”¨è¿›ç¨‹è€Œä¸æ˜¯çº¿ç¨‹ï¼Œå› ä¸ºæ›´ç¨³å®šå’Œå®‰å…¨ï¼Œæ¯ä¸ªè¿›ç¨‹ç‹¬ç«‹ï¼Œå´©æºƒä¸ä¼šå½±å“å…¶ä»–è¿›ç¨‹ã€‚
>
> æ€»ç»“èµ·æ¥ï¼Œå•çº¿ç¨‹å¤„ç†é«˜å¹¶å‘çš„å…³é”®åœ¨äºå¼‚æ­¥éé˜»å¡I/Oå’Œäº‹ä»¶å¾ªç¯ï¼Œå°†è€—æ—¶çš„I/Oæ“ä½œå§”æ‰˜ç»™ç³»ç»Ÿå¤„ç†ï¼Œä¸»çº¿ç¨‹å¿«é€Ÿå“åº”å…¶ä»–è¯·æ±‚ã€‚è€Œå¤šè¿›ç¨‹æ¶æ„é€šè¿‡clusteræ¨¡å—æˆ–å¤–éƒ¨å·¥å…·ï¼ˆå¦‚PM2ï¼‰åˆ›å»ºå¤šä¸ªå®ä¾‹ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸CPUï¼Œæé«˜å¤„ç†èƒ½åŠ›ã€‚åœ¨å¤„ç†ä¸åŒä»»åŠ¡ç±»å‹æ—¶ï¼Œé€‰æ‹©åˆé€‚çš„æ¨¡å‹è‡³å…³é‡è¦ï¼šå¼‚æ­¥å•çº¿ç¨‹é€‚åˆI/Oå¯†é›†å‹ï¼Œå¤šè¿›ç¨‹é€‚åˆåˆ©ç”¨å¤šæ ¸ï¼Œå·¥ä½œçº¿ç¨‹å¤„ç†CPUå¯†é›†å‹ä»»åŠ¡ã€‚
>
> ä¸è¿‡ä¸Šé¢è¿™äº›åªæ˜¯å¤§è‡´çš„è„‰ç»œï¼Œå¯èƒ½éœ€è¦æ›´æ·±å…¥çš„ç†è§£æ¯ä¸ªæ¨¡å—çš„å…·ä½“å®ç°ç»†èŠ‚ï¼Œæ¯”å¦‚libuvæ˜¯å¦‚ä½•ç®¡ç†çº¿ç¨‹æ± çš„ï¼Œclusteræ¨¡å—å¦‚ä½•åˆ†å‘è¯·æ±‚ï¼Œå­è¿›ç¨‹çš„åˆ›å»ºå’Œç®¡ç†æ–¹å¼ç­‰ã€‚å¦‚æœç¢°åˆ°å®é™…éƒ¨ç½²ä¸­çš„é—®é¢˜ï¼Œæ¯”å¦‚å†…å­˜æ³„æ¼æˆ–è´Ÿè½½ä¸å‡è¡¡ï¼Œåº”è¯¥å¦‚ä½•æ’æŸ¥å’Œä¼˜åŒ–ï¼Ÿè¿™ä¹Ÿæ˜¯åç»­éœ€è¦ç»§ç»­æ¢è®¨çš„æ–¹å‘ã€‚
>
> 



ä¸ºäº†æ¸…æ™°é˜è¿° Node.js çš„å•çº¿ç¨‹é«˜å¹¶å‘åŸç†ä¸å¤šè¿›ç¨‹æ¶æ„å®ç°ï¼Œæœ¬æ–‡é‡‡ç”¨åˆ†æ®µå¼è§£æå¹¶è¾…ä»¥æŠ€æœ¯å¯¹æ¯”ä¸ä»£ç ç¤ºä¾‹ï¼ŒåŠ›æ±‚å…¼é¡¾æ·±åº¦ä¸æ˜“è¯»æ€§ã€‚

---

### **ä¸€ã€å•çº¿ç¨‹ä¸é«˜å¹¶å‘çš„çŸ›ç›¾ä¸çœŸç›¸**

#### **è¯¯åŒºæ¾„æ¸…**
- **å•çº¿ç¨‹ â‰  æ€§èƒ½å¼±**ï¼šNode.js çš„ä¸»çº¿ç¨‹ï¼ˆäº‹ä»¶å¾ªç¯çº¿ç¨‹ï¼‰è´Ÿè´£ç¼–æ’ä»»åŠ¡ï¼Œè€—æ—¶ I/O æ“ä½œé€šè¿‡ **å¤šçº¿ç¨‹æ± **ï¼ˆlibuvï¼‰æˆ– **ç³»ç»Ÿå¼‚æ­¥æ¥å£**ï¼ˆå¦‚ epollã€kqueueï¼‰å®Œæˆï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚

#### **é«˜å¹¶å‘æ ¸å¿ƒæœºåˆ¶ï¼šäº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰æµç¨‹**

```bash
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚           Timers          â”‚  # æ‰§è¡Œ setTimeoutã€setInterval å›è°ƒ
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚     Pending I/O Callbacks â”‚  # å¤„ç†ç½‘ç»œã€æ–‡ä»¶ç­‰å®Œæˆçš„ I/O å›è°ƒ
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚       Idle/Prepare        â”‚  # å†…éƒ¨æœºåˆ¶ï¼Œå¿½ç•¥
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚           Poll            â”‚  â­ æ ¸å¿ƒé˜¶æ®µ ! 
   â”‚                           â”‚  - æ£€ç´¢æ–° I/O äº‹ä»¶ï¼ˆå¦‚æ¥å—æ–°è¿æ¥ï¼‰
   â”‚                           â”‚  - æ‰§è¡Œ I/O å›è°ƒï¼ˆè‹¥æ— å¯æ‰§è¡Œå›è°ƒåˆ™ç­‰å¾…ï¼‰
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚           Check           â”‚  # æ‰§è¡Œ setImmediate å›è°ƒ
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚      Close Callbacks      â”‚  # å…³é—­äº‹ä»¶å›è°ƒï¼ˆå¦‚ socket.on('close')ï¼‰
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **æŠ€æœ¯ä¼˜åŠ¿**
- **ä½å»¶è¿Ÿå“åº”**ï¼šä¸»çº¿ç¨‹ä¸“è´£è°ƒåº¦ï¼Œ6 ä¸‡+ QPS è½»æ¾åº”å¯¹ã€‚
- **èµ„æºæ¶ˆè€—ä½**ï¼šé¿å…å¤šçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ä¸é”ç«äº‰ï¼Œå•è¿›ç¨‹æ”¯æ’‘é«˜å¹¶å‘ã€‚

#### **æ€§èƒ½å±€é™** 
- **CPU å¯†é›†å‹ä»»åŠ¡**ï¼šå¦‚è§†é¢‘è½¬ç ã€å¤æ‚åŠ å¯†è¿ç®—ï¼Œå°†é˜»å¡äº‹ä»¶å¾ªç¯ã€‚
```javascript
// é”™è¯¯ç¤ºèŒƒï¼šåŒæ­¥é˜»å¡ä»£ç 
app.get('/encrypt', (req, res) => {
  const data = encryptLargeData(req.query.text); // è€—æ—¶è®¡ç®—é˜»å¡äº‹ä»¶å¾ªç¯
  res.send(data);
});

// è§£å†³æ–¹æ¡ˆï¼šæ”¹ç”¨ Worker çº¿ç¨‹
const { Worker } = require('worker_threads');
app.get('/encrypt', (req, res) => {
  const worker = new Worker('./encrypt-worker.js', { workerData: req.query.text });
  worker.on('message', data => res.send(data));
});
```

---

### **äºŒã€å¤šè¿›ç¨‹æ¶æ„çš„å®ç°ç­–ç•¥**

#### **1. åŸç”Ÿ Cluster æ¨¡å—**
**åŸç†**ï¼šMaster è¿›ç¨‹ç›‘å¬ç«¯å£å¹¶ç®¡ç† Worker è¿›ç¨‹çš„åˆ›å»ºä¸é€šä¿¡ï¼ŒWorker å…±äº«ç«¯å£é€šè¿‡ IPC å®ç°è´Ÿè½½å‡è¡¡ã€‚

```javascript
const cluster = require('cluster');
const http = require('http');
const numCPUs = require('os').cpus().length;

if (cluster.isMaster) {
  // Master è¿›ç¨‹åˆ›å»º Worker
  for (let i = 0; i < numCPUs; i++) {
    cluster.fork();
  }
  
  cluster.on('exit', (worker) => {
    console.log(`Worker ${worker.process.pid} died, restarting...`);
    cluster.fork();
  });
} else {
  // Worker è¿›ç¨‹å¯åŠ¨ HTTP æœåŠ¡
  http.createServer((req, res) => {
    res.writeHead(200);
    res.end(`Handled by Worker ${process.pid}`);
  }).listen(3000);
}
```

**å…³é”®ç‰¹æ€§**ï¼š
- **ç«¯å£å…±äº«**ï¼šæ‰€æœ‰ Worker é€šè¿‡ `SO_REUSEPORT` å¤ç”¨ç«¯å£ï¼Œæ— éœ€åå‘ä»£ç†ã€‚
- **è´Ÿè½½å‡è¡¡**ï¼šé»˜è®¤é‡‡ç”¨ Round-Robin ç®—æ³•ï¼ˆLinux ä¸‹ä¼˜åŒ–ä¸ºæ›´æ™ºèƒ½çš„æŠ¢å å¼è°ƒåº¦ï¼‰ã€‚
- **å®¹é”™æœºåˆ¶**ï¼šMaster è‡ªåŠ¨é‡å¯å´©æºƒçš„ Workerã€‚

#### **2. PM2 è¿›ç¨‹ç®¡ç†å™¨**
**é«˜é˜¶å°è£…**ï¼šCluster + ç›‘æ§ã€æ—¥å¿—ã€é›¶åœæœºé‡å¯ç­‰ä¼ä¸šçº§åŠŸèƒ½ã€‚
```bash
# å¯åŠ¨ 4 ä¸ª Worker è¿›ç¨‹
pm2 start app.js -i 4

# åŠ¨æ€è°ƒæ•´è¿›ç¨‹æ•°
pm2 scale app 8

# é›¶åœæœºçƒ­æ›´æ–°
pm2 reload app
```

#### **3. å¤šè¿›ç¨‹é€šä¿¡ï¼ˆIPCï¼‰**
**ç¤ºä¾‹ï¼šä¸»è¿›ç¨‹ä¸ Worker äº¤æ¢æ•°æ®**
```javascript
// Master è¿›ç¨‹
cluster.on('message', (worker, message) => {
  console.log(`Received message from ${worker.id}:`, message);
  worker.send({ response: 'ACK' });
});

// Worker è¿›ç¨‹
process.on('message', (msg) => {
  console.log('Master says:', msg);
});
process.send({ request: 'DATA' });
```

---

### **ä¸‰ã€æŠ€æœ¯é€‰å‹å¯¹æ¯”**

| **åœºæ™¯**                | **å•çº¿ç¨‹æ–¹æ¡ˆ**              | **Cluster**               | **PM2**                    | **Worker Threads**        |
|-------------------------|---------------------------|---------------------------|----------------------------|---------------------------|
| **é€‚ç”¨ä»»åŠ¡ç±»å‹**         | I/O å¯†é›†å‹                | é€šç”¨                      | ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²               | CPU å¯†é›†å‹                |
| **èµ„æºå ç”¨**            | ä½ï¼ˆå•è¿›ç¨‹ï¼‰              | ä¸­ï¼ˆå¤šè¿›ç¨‹ï¼‰              | ä¸­ï¼ˆä¾èµ–é…ç½®ï¼‰             | é«˜ï¼ˆæ¯ä¸ªçº¿ç¨‹ç‹¬ç«‹ V8 å®ä¾‹ï¼‰|
| **å¼€å‘å¤æ‚åº¦**          | ç®€å•                      | ä¸­ç­‰                      | ç®€å•ï¼ˆCLI å·¥å…·ï¼‰           | é«˜ï¼ˆéœ€ç®¡ç†çº¿ç¨‹é€šä¿¡ï¼‰      |
| **å®¹é”™èƒ½åŠ›**            | è¿›ç¨‹å´©æºƒå³æœåŠ¡ä¸­æ–­        | Master è‡ªåŠ¨é‡å¯ Worker    | è‡ªåŠ¨é‡å¯ã€æ—¥å¿—è¿½è¸ª         | çº¿ç¨‹å´©æºƒéœ€è‡ªè¡Œå¤„ç†        |
| **å…¸å‹åº”ç”¨**            | API ç½‘å…³ã€å®æ—¶æ¶ˆæ¯æ¨é€    | å¤šæ ¸ HTTP æœåŠ¡            | å¾®æœåŠ¡é›†ç¾¤                 | å›¾åƒå¤„ç†ã€å¤§æ•°æ®è®¡ç®—      |

---

### **å››ã€æœ€ä½³å®è·µæŒ‡å—**

1. **åˆ†å±‚æ¶æ„è®¾è®¡**  
   - å‰ç«¯è´Ÿè½½å‡è¡¡ï¼ˆNginxï¼‰ â†’ PM2 é›†ç¾¤ â†’ å†…éƒ¨å¾®æœåŠ¡ï¼ˆCluster + IPCï¼‰
   
2. **è¿›ç¨‹ç²’åº¦æ§åˆ¶**  
   - Worker æ•°é‡ â‰ˆ CPU æ ¸å¿ƒæ•°ï¼ˆé¿å…è¿‡åº¦åˆ‡æ¢ï¼‰
   - CPU å¯†é›†å‹ä»»åŠ¡éš”ç¦»åˆ°ç‹¬ç«‹è¿›ç¨‹æˆ–çº¿ç¨‹ã€‚

3. **å¥åº·ç›‘æ§**  
   ```javascript
   // ç»“åˆ PM2 ç›‘æ§
   pm2 monit

   // è‡ªå®šä¹‰æŒ‡æ ‡ä¸ŠæŠ¥
   const { meter } = require('@opentelemetry/api');
   const requestCounter = meter.createCounter('http_requests');
   app.use((req, res, next) => {
     requestCounter.add(1);
     next();
   });
   ```

4. **ä¼˜é›…é€€å‡ºæœºåˆ¶**  
   ```javascript
   process.on('SIGINT', () => {
     server.close(() => {
       console.log('Server closed');
       process.exit(0);
     });
     // å¼ºåˆ¶é€€å‡ºè¶…æ—¶å¤„ç†
     setTimeout(() => process.exit(1), 5000);
   });
   ```

---

### **äº”ã€æ€»ç»“**
Node.js çš„å•çº¿ç¨‹æ¨¡å‹é€šè¿‡äº‹ä»¶å¾ªç¯ä¸ **éé˜»å¡ I/O** å®ç°é«˜å¹¶å‘ï¼Œè€Œå¤šè¿›ç¨‹æ¶æ„åˆ™çªç ´äº†å•æ ¸ CPU çš„é™åˆ¶ã€‚ç†è§£å…¶åº•å±‚æœºåˆ¶åï¼Œå¯é’ˆå¯¹åœºæ™¯é€‰æ‹© Clusterã€PM2 æˆ– Worker Threads è¿›è¡Œæ‰©å±•ï¼Œåœ¨ I/O å¯†é›†å‹ä¸ CPU å¯†é›†å‹ä»»åŠ¡é—´å®ç°æœ€ä½³å¹³è¡¡ã€‚æœªæ¥çš„ Deno æˆ– Bun è™½åœ¨æ€§èƒ½ä¸Šæ›´è¿›ä¸€æ­¥ï¼Œä½† Node.js æˆç†Ÿçš„ç”Ÿæ€ä¸å¤šè¿›ç¨‹èŒƒå¼ä»æ˜¯ä¼ä¸šçº§åº”ç”¨çš„é¦–é€‰æ–¹æ¡ˆä¹‹ä¸€ã€‚
