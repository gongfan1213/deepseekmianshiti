å¥½çš„ï¼æˆ‘ä»¬ç»§ç»­æ·±å…¥è®²è§£ **Babylon.js æè´¨å’Œçº¹ç†** çš„ä¸‹ä¸€éƒ¨åˆ†å†…å®¹ã€‚è¿™æ¬¡æˆ‘ä»¬å°†è¯¦ç»†è®²è§£ **ç¯å¢ƒè´´å›¾ï¼ˆEnvironment Textureï¼‰å’Œåå°„æ•ˆæœ**ï¼Œå› ä¸ºç¯å¢ƒè´´å›¾æ˜¯ 3D æ¸²æŸ“ä¸­éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå¯ä»¥è®©ç‰©ä½“è¡¨é¢å‘ˆç°å‡ºçœŸå®çš„åå°„æ•ˆæœï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨ PBR æè´¨æ—¶ã€‚

---

## **ç¯å¢ƒè´´å›¾ï¼ˆEnvironment Textureï¼‰å’Œåå°„æ•ˆæœ**

### **1. ä»€ä¹ˆæ˜¯ç¯å¢ƒè´´å›¾ï¼Ÿ**
ç¯å¢ƒè´´å›¾ï¼ˆEnvironment Textureï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¹ç†ï¼Œç”¨äºæ¨¡æ‹Ÿç‰©ä½“è¡¨é¢å¯¹å‘¨å›´ç¯å¢ƒçš„åå°„ã€‚å®ƒé€šå¸¸æ˜¯ä¸€ä¸ªå…¨æ™¯å›¾åƒï¼ˆå¦‚ HDR æˆ– Cube Mapï¼‰ï¼Œå¯ä»¥è®©ç‰©ä½“çœ‹èµ·æ¥åƒæ˜¯åœ¨çœŸå®çš„ç¯å¢ƒä¸­ã€‚

åœ¨ Babylon.js ä¸­ï¼Œç¯å¢ƒè´´å›¾å¯ä»¥ç”¨äºï¼š
- **åå°„**ï¼šæ¨¡æ‹Ÿç‰©ä½“è¡¨é¢å¯¹å‘¨å›´ç¯å¢ƒçš„åå°„ã€‚
- **æŠ˜å°„**ï¼šæ¨¡æ‹Ÿé€æ˜ç‰©ä½“ï¼ˆå¦‚ç»ç’ƒï¼‰å¯¹å…‰çº¿çš„æŠ˜å°„ã€‚
- **å…‰ç…§**ï¼šä¸ºåœºæ™¯æä¾›å…¨å±€å…‰ç…§ï¼ˆå°¤å…¶æ˜¯åœ¨ PBR æè´¨ä¸­ï¼‰ã€‚

---

### **2. åŠ è½½ç¯å¢ƒè´´å›¾**
Babylon.js æä¾›äº†å¤šç§æ–¹å¼åŠ è½½ç¯å¢ƒè´´å›¾ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ä½¿ç”¨ `CubeTexture` æˆ– `HDRCubeTexture`ã€‚

#### **(1) ä½¿ç”¨ CubeTexture**
`CubeTexture` æ˜¯ä¸€ç§ç«‹æ–¹ä½“è´´å›¾ï¼Œç”± 6 å¼ å›¾ç‰‡ç»„æˆï¼Œåˆ†åˆ«è¡¨ç¤ºç¯å¢ƒçš„ä¸Šä¸‹å·¦å³å‰åã€‚

```javascript
const cubeTexture = new BABYLON.CubeTexture("https://playground.babylonjs.com/textures/environment.env", scene);
scene.environmentTexture = cubeTexture; // è®¾ç½®åœºæ™¯çš„ç¯å¢ƒè´´å›¾
```

- `CubeTexture`ï¼šåŠ è½½ä¸€ä¸ªç«‹æ–¹ä½“è´´å›¾ã€‚
- `scene.environmentTexture`ï¼šå°†ç¯å¢ƒè´´å›¾åº”ç”¨åˆ°æ•´ä¸ªåœºæ™¯ã€‚

#### **(2) ä½¿ç”¨ HDRCubeTexture**
`HDRCubeTexture` æ˜¯ä¸€ç§é«˜åŠ¨æ€èŒƒå›´ï¼ˆHDRï¼‰çš„ç«‹æ–¹ä½“è´´å›¾ï¼Œé€šå¸¸ç”¨äºæ›´é«˜è´¨é‡çš„å…‰ç…§å’Œåå°„æ•ˆæœã€‚

```javascript
const hdrTexture = new BABYLON.HDRCubeTexture("https://playground.babylonjs.com/textures/environment.hdr", scene, 512);
scene.environmentTexture = hdrTexture; // è®¾ç½®åœºæ™¯çš„ç¯å¢ƒè´´å›¾
```

- `HDRCubeTexture`ï¼šåŠ è½½ä¸€ä¸ª HDR æ ¼å¼çš„ç«‹æ–¹ä½“è´´å›¾ã€‚
- `512`ï¼šæŒ‡å®šè´´å›¾çš„åˆ†è¾¨ç‡ã€‚

---

### **3. ç¯å¢ƒè´´å›¾çš„åº”ç”¨**
ç¯å¢ƒè´´å›¾å¯ä»¥åº”ç”¨åˆ°åœºæ™¯ä¸­çš„æ‰€æœ‰ç‰©ä½“ï¼Œä¹Ÿå¯ä»¥å•ç‹¬åº”ç”¨åˆ°æŸä¸ªæè´¨ã€‚

#### **(1) åº”ç”¨åˆ°æ•´ä¸ªåœºæ™¯**
```javascript
scene.environmentTexture = cubeTexture; // è®¾ç½®åœºæ™¯çš„ç¯å¢ƒè´´å›¾
scene.createDefaultSkybox(cubeTexture, true, 1000); // åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„å¤©ç©ºç›’
```

- `createDefaultSkybox`ï¼šä¸ºåœºæ™¯åˆ›å»ºä¸€ä¸ªå¤©ç©ºç›’ï¼Œä½¿ç”¨ç¯å¢ƒè´´å›¾ä½œä¸ºèƒŒæ™¯ã€‚

#### **(2) åº”ç”¨åˆ°å•ä¸ªæè´¨**
```javascript
const pbrMaterial = new BABYLON.PBRMaterial("pbrMaterial", scene);
pbrMaterial.environmentTexture = cubeTexture; // å°†ç¯å¢ƒè´´å›¾åº”ç”¨åˆ° PBR æè´¨
```

- `environmentTexture`ï¼šä¸ºæè´¨è®¾ç½®ç¯å¢ƒè´´å›¾ï¼Œç”¨äºåå°„å’ŒæŠ˜å°„æ•ˆæœã€‚

---

### **4. åå°„æ•ˆæœ**
åå°„æ•ˆæœæ˜¯ç¯å¢ƒè´´å›¾çš„ä¸€ä¸ªé‡è¦åº”ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨é‡‘å±æˆ–å…‰æ»‘è¡¨é¢ä¸Šã€‚

#### **ä»£ç ç¤ºä¾‹ï¼šåå°„æ•ˆæœ**
ä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä¸ºä¸€ä¸ªçƒä½“æ·»åŠ åå°„æ•ˆæœï¼š

```javascript
const sphere = BABYLON.MeshBuilder.CreateSphere("sphere", { diameter: 2 }, scene);
const pbrMaterial = new BABYLON.PBRMaterial("pbrMaterial", scene);
pbrMaterial.metallic = 1; // è®¾ç½®é‡‘å±åº¦ä¸º 1
pbrMaterial.roughness = 0; // è®¾ç½®ç²—ç³™åº¦ä¸º 0ï¼ˆå®Œå…¨å…‰æ»‘ï¼‰
pbrMaterial.environmentTexture = cubeTexture; // æ·»åŠ ç¯å¢ƒè´´å›¾
sphere.material = pbrMaterial;
```

- `metallic = 1`ï¼šç‰©ä½“å®Œå…¨åƒé‡‘å±ä¸€æ ·åå°„å…‰çº¿ã€‚
- `roughness = 0`ï¼šç‰©ä½“è¡¨é¢å®Œå…¨å…‰æ»‘ï¼Œåå°„éå¸¸æ¸…æ™°ã€‚

---

### **5. æŠ˜å°„æ•ˆæœ**
æŠ˜å°„æ•ˆæœç”¨äºæ¨¡æ‹Ÿé€æ˜ç‰©ä½“ï¼ˆå¦‚ç»ç’ƒæˆ–æ°´ï¼‰å¯¹å…‰çº¿çš„æŠ˜å°„ã€‚

#### **ä»£ç ç¤ºä¾‹ï¼šæŠ˜å°„æ•ˆæœ**
ä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä¸ºä¸€ä¸ªçƒä½“æ·»åŠ æŠ˜å°„æ•ˆæœï¼š

```javascript
const sphere = BABYLON.MeshBuilder.CreateSphere("sphere", { diameter: 2 }, scene);
const pbrMaterial = new BABYLON.PBRMaterial("pbrMaterial", scene);
pbrMaterial.indexOfRefraction = 1.5; // è®¾ç½®æŠ˜å°„ç‡ï¼ˆç»ç’ƒçš„æŠ˜å°„ç‡çº¦ä¸º 1.5ï¼‰
pbrMaterial.environmentTexture = cubeTexture; // æ·»åŠ ç¯å¢ƒè´´å›¾
pbrMaterial.subSurface.isRefractionEnabled = true; // å¯ç”¨æŠ˜å°„
sphere.material = pbrMaterial;
```

- `indexOfRefraction`ï¼šè®¾ç½®ç‰©ä½“çš„æŠ˜å°„ç‡ã€‚
- `subSurface.isRefractionEnabled`ï¼šå¯ç”¨æŠ˜å°„æ•ˆæœã€‚

---

### **6. ç¤ºä¾‹ä»£ç ï¼šç¯å¢ƒè´´å›¾çš„ç»¼åˆåº”ç”¨**
ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ç¯å¢ƒè´´å›¾å®ç°åå°„å’ŒæŠ˜å°„æ•ˆæœã€‚

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Babylon.js ç¯å¢ƒè´´å›¾ç¤ºä¾‹</title>
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
</head>
<body>
    <canvas id="renderCanvas" style="width: 100%; height: 100%;"></canvas>

    <script>
        const canvas = document.getElementById("renderCanvas");
        const engine = new BABYLON.Engine(canvas, true);

        const createScene = function () {
            const scene = new BABYLON.Scene(engine);

            // æ·»åŠ æ‘„åƒæœº
            const camera = new BABYLON.ArcRotateCamera("camera", Math.PI / 2, Math.PI / 2, 10, BABYLON.Vector3.Zero(), scene);
            camera.attachControl(canvas, true);

            // æ·»åŠ å…‰æº
            const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);

            // åŠ è½½ç¯å¢ƒè´´å›¾
            const cubeTexture = new BABYLON.CubeTexture("https://playground.babylonjs.com/textures/environment.env", scene);
            scene.environmentTexture = cubeTexture; // è®¾ç½®åœºæ™¯çš„ç¯å¢ƒè´´å›¾
            scene.createDefaultSkybox(cubeTexture, true, 1000); // åˆ›å»ºå¤©ç©ºç›’

            // åˆ›å»ºä¸€ä¸ªåå°„çƒä½“
            const reflectiveSphere = BABYLON.MeshBuilder.CreateSphere("reflectiveSphere", { diameter: 2 }, scene);
            const reflectiveMaterial = new BABYLON.PBRMaterial("reflectiveMaterial", scene);
            reflectiveMaterial.metallic = 1; // å®Œå…¨é‡‘å±
            reflectiveMaterial.roughness = 0; // å®Œå…¨å…‰æ»‘
            reflectiveMaterial.environmentTexture = cubeTexture; // æ·»åŠ ç¯å¢ƒè´´å›¾
            reflectiveSphere.material = reflectiveMaterial;
            reflectiveSphere.position.x = -2;

            // åˆ›å»ºä¸€ä¸ªæŠ˜å°„çƒä½“
            const refractiveSphere = BABYLON.MeshBuilder.CreateSphere("refractiveSphere", { diameter: 2 }, scene);
            const refractiveMaterial = new BABYLON.PBRMaterial("refractiveMaterial", scene);
            refractiveMaterial.indexOfRefraction = 1.5; // è®¾ç½®æŠ˜å°„ç‡
            refractiveMaterial.environmentTexture = cubeTexture; // æ·»åŠ ç¯å¢ƒè´´å›¾
            refractiveMaterial.subSurface.isRefractionEnabled = true; // å¯ç”¨æŠ˜å°„
            refractiveSphere.material = refractiveMaterial;
            refractiveSphere.position.x = 2;

            return scene;
        };

        const scene = createScene();

        engine.runRenderLoop(function () {
            scene.render();
        });

        window.addEventListener("resize", function () {
            engine.resize();
        });
    </script>
</body>
</html>
```

---

### **7. è¿è¡Œæ•ˆæœ**
1. æ‰“å¼€æµè§ˆå™¨è¿è¡Œä¸Šè¿°ä»£ç ã€‚
2. ä½ ä¼šçœ‹åˆ°ï¼š
   - ä¸€ä¸ªåå°„çƒä½“åœ¨å·¦ä¾§ï¼Œè¡¨é¢ä¼šåå°„ç¯å¢ƒè´´å›¾ä¸­çš„å†…å®¹ã€‚
   - ä¸€ä¸ªæŠ˜å°„çƒä½“åœ¨å³ä¾§ï¼Œè¡¨é¢ä¼šæ¨¡æ‹Ÿç»ç’ƒçš„æŠ˜å°„æ•ˆæœã€‚
   - èƒŒæ™¯æ˜¯ä¸€ä¸ªå¤©ç©ºç›’ï¼Œæ˜¾ç¤ºäº†ç¯å¢ƒè´´å›¾çš„å†…å®¹ã€‚

---

### **8. æ³¨æ„äº‹é¡¹**
1. **ç¯å¢ƒè´´å›¾çš„æ ¼å¼**
   - ä½¿ç”¨ `.env` æˆ– `.hdr` æ ¼å¼çš„é«˜è´¨é‡ç¯å¢ƒè´´å›¾å¯ä»¥è·å¾—æ›´å¥½çš„æ•ˆæœã€‚
   - Babylon.js æä¾›äº†å·¥å…·å°†æ™®é€šå›¾ç‰‡è½¬æ¢ä¸º `.env` æ ¼å¼ã€‚

2. **æ€§èƒ½ä¼˜åŒ–**
   - ç¯å¢ƒè´´å›¾çš„åˆ†è¾¨ç‡ä¼šå½±å“æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šã€‚
   - å¯ä»¥ä½¿ç”¨ä½åˆ†è¾¨ç‡çš„ç¯å¢ƒè´´å›¾æ¥ä¼˜åŒ–æ€§èƒ½ã€‚

3. **å…‰ç…§çš„é‡è¦æ€§**
   - ç¯å¢ƒè´´å›¾å¯ä»¥ä¸ºåœºæ™¯æä¾›å…¨å±€å…‰ç…§ï¼Œä½†æœ€å¥½ç»“åˆå…¶ä»–å…‰æºï¼ˆå¦‚ç‚¹å…‰æºæˆ–èšå…‰ç¯ï¼‰ä½¿ç”¨ã€‚

---

### **9. å°ç»“**
- **ç¯å¢ƒè´´å›¾** æ˜¯æ¨¡æ‹Ÿåå°„å’ŒæŠ˜å°„æ•ˆæœçš„é‡è¦å·¥å…·ã€‚
- **åå°„æ•ˆæœ**ï¼šé€šè¿‡è®¾ç½® `metallic` å’Œ `roughness` å±æ€§å®ç°ã€‚
- **æŠ˜å°„æ•ˆæœ**ï¼šé€šè¿‡è®¾ç½® `indexOfRefraction` å’Œå¯ç”¨ `subSurface.isRefractionEnabled` å®ç°ã€‚
- **å¤©ç©ºç›’**ï¼šå¯ä»¥ä½¿ç”¨ç¯å¢ƒè´´å›¾ä½œä¸ºåœºæ™¯çš„èƒŒæ™¯ã€‚

---

å¦‚æœä½ å¯¹å…¶ä»–éƒ¨åˆ†ï¼ˆæ¯”å¦‚åŠ¨ç”»ã€äº¤äº’ç­‰ï¼‰æ„Ÿå…´è¶£ï¼Œæˆ–è€…æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼ ğŸ˜Š
